CREATE TABLE EMPLOYEES (
    EMPLOYEE_ID NUMBER PRIMARY KEY,
    FIRST_NAME VARCHAR2(50),
    LAST_NAME VARCHAR2(50),
    EMAIL VARCHAR2(100),
    HIRE_DATE DATE,
    JOB_ID VARCHAR2(20),
    SALARY NUMBER(10,2),
    DEPARTMENT_ID NUMBER
);
CREATE TABLE SALES (
    SALE_ID NUMBER PRIMARY KEY,
    PRODUCT_ID NUMBER,
    SALE_DATE DATE,
    QUANTITY NUMBER,
    TOTAL_AMOUNT NUMBER(12,2)
);
CREATE TABLE SALES_HISTORY (
    SALE_ID NUMBER PRIMARY KEY,
    PRODUCT_ID NUMBER,
    SALE_DATE DATE,
    QUANTITY NUMBER,
    TOTAL_AMOUNT NUMBER(12,2)
);
CREATE TABLE PRODUCTS (
    PRODUCT_ID NUMBER PRIMARY KEY,
    PRODUCT_NAME VARCHAR2(100),
    PRICE NUMBER(10,2),
    STOCK_QUANTITY NUMBER
);
CREATE TABLE NEW_PRODUCTS (
    PRODUCT_ID NUMBER PRIMARY KEY,
    PRODUCT_NAME VARCHAR2(100),
    PRICE NUMBER(10,2),
    STOCK_QUANTITY NUMBER
);
CREATE TABLE EMPLOYEE_SUMMARY (
    DEPARTMENT_ID NUMBER PRIMARY KEY,
    TOTAL_EMPLOYEES NUMBER,
    TOTAL_SALARY NUMBER(12,2)
);
CREATE TABLE ORDERS (
    ORDER_ID NUMBER PRIMARY KEY,
    CUSTOMER_ID NUMBER,
    ORDER_DATE DATE,
    STATUS VARCHAR2(20)
);
INSERT INTO EMPLOYEES VALUES (101, 'John', 'Doe', 'jdoe@example.com', DATE '2019-01-15', 'IT_PROG', 70000, 1);
INSERT INTO EMPLOYEES VALUES (102, 'Alice', 'Smith', 'asmith@example.com', DATE '2018-03-20', 'HR_REP', 50000, 2);
INSERT INTO EMPLOYEES VALUES (103, 'Bob', 'Brown', 'bbrown@example.com', DATE '2005-06-10', 'IT_PROG', 80000, 1);
INSERT INTO EMPLOYEES VALUES (104, 'Charlie', 'Davis', 'cdavis@example.com', DATE '2001-11-05', 'FIN_ANALYST', 60000, 3);
INSERT INTO EMPLOYEES VALUES (105, 'Eva', 'Miller', 'emiller@example.com', DATE '2010-08-12', 'IT_PROG', 75000, 1);
INSERT INTO EMPLOYEES VALUES (106, 'Frank', 'Wilson', 'fwilson@example.com', DATE '2017-12-01', 'HR_REP', 52000, 2);
INSERT INTO EMPLOYEES VALUES (107, 'Grace', 'Taylor', 'gtaylor@example.com', DATE '2016-05-22', 'FIN_ANALYST', 62000, 3);
INSERT INTO EMPLOYEES VALUES (108, 'Hannah', 'Anderson', 'handerson@example.com', DATE '2003-09-15', 'IT_PROG', 71000, 1);
INSERT INTO EMPLOYEES VALUES (109, 'Ian', 'Thomas', 'ithomas@example.com', DATE '2015-04-10', 'HR_REP', 53000, 2);
INSERT INTO EMPLOYEES VALUES (110, 'Jack', 'Jackson', 'jjackson@example.com', DATE '2000-07-30', 'FIN_ANALYST', 60000, 3);

INSERT INTO SALES VALUES (201, 1001, DATE '2025-01-10', 5, 500);
INSERT INTO SALES VALUES (202, 1002, DATE '2025-02-15', 3, 300);
INSERT INTO SALES VALUES (203, 1003, DATE '2025-03-05', 10, 1000);
INSERT INTO SALES VALUES (204, 1004, DATE '2025-04-10', 2, 200);
INSERT INTO SALES VALUES (205, 1005, DATE '2025-05-12', 7, 700);
INSERT INTO SALES VALUES (206, 1006, DATE '2025-06-20', 1, 100);
INSERT INTO SALES VALUES (207, 1007, DATE '2025-07-25', 4, 400);
INSERT INTO SALES VALUES (208, 1008, DATE '2025-08-15', 6, 600);
INSERT INTO SALES VALUES (209, 1009, DATE '2025-09-10', 8, 800);
INSERT INTO SALES VALUES (210, 1010, DATE '2025-10-05', 9, 900);

INSERT INTO SALES_HISTORY VALUES (301, 1001, DATE '2024-01-10', 5, 500);
INSERT INTO SALES_HISTORY VALUES (302, 1002, DATE '2024-02-15', 3, 300);
INSERT INTO SALES_HISTORY VALUES (303, 1003, DATE '2024-03-05', 10, 1000);
INSERT INTO SALES_HISTORY VALUES (304, 1004, DATE '2024-04-10', 2, 200);
INSERT INTO SALES_HISTORY VALUES (305, 1005, DATE '2024-05-12', 7, 700);
INSERT INTO SALES_HISTORY VALUES (306, 1006, DATE '2024-06-20', 1, 100);
INSERT INTO SALES_HISTORY VALUES (307, 1007, DATE '2024-07-25', 4, 400);
INSERT INTO SALES_HISTORY VALUES (308, 1008, DATE '2024-08-15', 6, 600);
INSERT INTO SALES_HISTORY VALUES (309, 1009, DATE '2024-09-10', 8, 800);
INSERT INTO SALES_HISTORY VALUES (310, 1010, DATE '2024-10-05', 9, 900);

INSERT INTO PRODUCTS VALUES (1001, 'Laptop', 100, 50);
INSERT INTO PRODUCTS VALUES (1002, 'Mouse', 20, 200);
INSERT INTO PRODUCTS VALUES (1003, 'Keyboard', 30, 150);
INSERT INTO PRODUCTS VALUES (1004, 'Monitor', 150, 40);
INSERT INTO PRODUCTS VALUES (1005, 'Printer', 200, 30);
INSERT INTO PRODUCTS VALUES (1006, 'Desk', 300, 20);
INSERT INTO PRODUCTS VALUES (1007, 'Chair', 100, 100);
INSERT INTO PRODUCTS VALUES (1008, 'USB Drive', 10, 500);
INSERT INTO PRODUCTS VALUES (1009, 'Headset', 50, 120);
INSERT INTO PRODUCTS VALUES (1010, 'Webcam', 80, 60);

INSERT INTO NEW_PRODUCTS VALUES (1001, 'Laptop Pro', 120, 40);  -- Existing product, will update
INSERT INTO NEW_PRODUCTS VALUES (1002, 'Mouse', 22, 180);       -- Existing product, update
INSERT INTO NEW_PRODUCTS VALUES (1011, 'Tablet', 250, 30);      -- New product
INSERT INTO NEW_PRODUCTS VALUES (1012, 'Smartphone', 500, 25); -- New product
INSERT INTO NEW_PRODUCTS VALUES (1013, 'Desk Lamp', 45, 70);   -- New product
INSERT INTO NEW_PRODUCTS VALUES (1014, 'Router', 60, 60);      -- New product
INSERT INTO NEW_PRODUCTS VALUES (1015, 'External HDD', 100, 50);-- New product
INSERT INTO NEW_PRODUCTS VALUES (1005, 'Printer XL', 220, 25); -- Existing product, update
INSERT INTO NEW_PRODUCTS VALUES (1006, 'Desk', 310, 15);       -- Existing product, update
INSERT INTO NEW_PRODUCTS VALUES (1016, 'Chair Pro', 120, 80);  -- New product

INSERT INTO ORDERS VALUES (501, 1, DATE '2025-09-01', 'PENDING');
INSERT INTO ORDERS VALUES (502, 2, DATE '2025-09-10', 'COMPLETED');
INSERT INTO ORDERS VALUES (503, 3, DATE '2025-08-15', 'PENDING');
INSERT INTO ORDERS VALUES (504, 4, DATE '2025-07-20', 'COMPLETED');
INSERT INTO ORDERS VALUES (505, 5, DATE '2025-06-05', 'PENDING');
INSERT INTO ORDERS VALUES (506, 6, DATE '2025-05-12', 'CANCELLED');
INSERT INTO ORDERS VALUES (507, 7, DATE '2025-04-10', 'PENDING');
INSERT INTO ORDERS VALUES (508, 8, DATE '2025-03-22', 'COMPLETED');
INSERT INTO ORDERS VALUES (509, 9, DATE '2025-02-14', 'PENDING');
INSERT INTO ORDERS VALUES (510, 10, DATE '2025-01-30', 'COMPLETED');

INSERT INTO EMPLOYEES VALUES (301, 'John', 'Doe', 'jdoe@example.com', SYSDATE, 'IT_PROG', 75000,3);

INSERT EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, HIRE_DATE, JOB_ID, SALARY)
VALUES (301, 'John', 'Doe', 'jdoe@example.com', SYSDATE, 'IT_PROG', 75000);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, HIRE_DATE, JOB_ID, SALARY,DEPARTMENT_ID)
VALUES (302, 'Myat', 'Zaw', 'jdoe@example.com', SYSDATE, 'IT_PROG', 75000,2);

INSERT VALUES (301, 'John', 'Doe', 'jdoe@example.com', SYSDATE, 'IT_PROG', 75000) INTO EMPLOYEES;

UPDATE EMPLOYEES SET SALARY = SALARY * 1.1 WHERE JOB_ID = 'IT_PROG';

DELETE EMPLOYEES WHERE HIRE_DATE < '01-JAN-2000';

DELETE FROM EMPLOYEES WHERE HIRE_DATE < TO_DATE('2000-01-01', 'YYYY-MM-DD');

INSERT INTO SALES_HISTORY 
SELECT * FROM SALES 
WHERE SALE_DATE < ADD_MONTHS(SYSDATE, -12);

SELECT * from SALES_HISTORY;

MERGE INTO PRODUCTS p 
USING NEW_PRODUCTS np 
ON (p.PRODUCT_ID = np.PRODUCT_ID) 
WHEN MATCHED THEN 
    UPDATE SET p.PRODUCT_NAME = np.PRODUCT_NAME, 
               p.PRICE = np.PRICE, 
               p.STOCK_QUANTITY = np.STOCK_QUANTITY 
WHEN NOT MATCHED THEN 
    INSERT (PRODUCT_ID, PRODUCT_NAME, PRICE, STOCK_QUANTITY) 
    VALUES (np.PRODUCT_ID, np.PRODUCT_NAME, np.PRICE, np.STOCK_QUANTITY);

UPDATE SALES 
SET TOTAL_AMOUNT = QUANTITY * 
(SELECT PRICE FROM PRODUCTS 
WHERE PRODUCTS.PRODUCT_ID = SALES.PRODUCT_ID);

INSERT INTO EMPLOYEE_SUMMARY 
SELECT DEPARTMENT_ID, COUNT(*), SUM(SALARY) 
FROM EMPLOYEES 
GROUP BY DEPARTMENT_ID;

UPDATE ORDERS 
SET STATUS = 'CANCELLED' 
WHERE ORDER_DATE < SYSDATE - 30 
AND STATUS = 'PENDING'; 